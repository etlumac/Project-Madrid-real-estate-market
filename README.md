# Project-Madrid-real-estate-market

# Прогнозирование цен на рынке недвижимости в Мадриде

Этот проект посвящен анализу и прогнозированию цен на недвижимость в Мадриде с использованием машинного обучения. Используются три модели регрессии для предсказания стоимости недвижимости на основе различных атрибутов, таких как площадь, количество этажей, наличие лифта и пр.

## 1. Описание данных

Данные взяты с Kaggle и содержат информацию о недвижимости в Мадриде, Испания. Датасет включает в себя такие атрибуты, как общая площадь, год постройки, этажность, наличие лифта, сада, паркинга и другие факторы, которые могут влиять на цену.

## 2. Загрузка и предварительная обработка данных

### Загрузка данных и установка библиотек
Используем библиотеки `pandas`, `sklearn`, и `xgboost`. Загружаем данные из CSV-файла и просматриваем их структуру и первые строки, чтобы ознакомиться с основными атрибутами.

### Очистка данных
Удалены столбцы, не влияющие на цену недвижимости: например, `id`, `title`, `subtitle`, координаты, данные о разрешении на аренду и некоторые географические идентификаторы. Также удаляются столбцы с большим количеством пропущенных значений.

### Обработка пропущенных значений
- Для числовых признаков: заменяем пропуски на среднее значение.
- Для категориальных признаков: заменяем пропуски модой (наиболее часто встречающимся значением).
- Для булевых признаков: заменяем пропуски значением `False`.

### Преобразование категориальных и булевых признаков
Булевые значения преобразованы в целочисленный формат (1 для `True` и 0 для `False`). Порядковые значения, такие как этажность, заменены на числовой эквивалент.

## 3. Построение моделей

Целевая переменная — `buy_price`, которая представляет стоимость недвижимости. Признаки (X) и целевая переменная (y) разделены, а также выполнено разбиение на обучающую и тестовую выборки.

### Используемые модели
1. **Линейная регрессия** — для базового сравнения.
2. **Случайный лес** — для повышения точности и учета нелинейных взаимосвязей.
3. **Градиентный бустинг (XGBoost)** — для максимальной точности при большем объеме данных.

### Обучение моделей
Каждая модель обучается на тренировочной выборке, после чего прогнозы проверяются на тестовой выборке.

## 4. Оценка моделей

Оценка моделей проводится с помощью метрик R², MAE (средняя абсолютная ошибка) и Median AE (медианная абсолютная ошибка).

### Визуализация результатов
Созданы графики, показывающие, насколько точно предсказанные значения совпадают с реальными ценами. Лучшая модель определяется по точности на основе близости точек к диагонали и показателей метрик.

### Метрики:
- **Линейная регрессия**: R²: 0.85, MAE: 162,874, Median AE: 97,993
- **Случайный лес**: R²: 0.9994, MAE: 2,949, Median AE: 8.1
- **Градиентный бустинг**: R²: 0.9997, MAE: 4,622, Median AE: 1,694

Модели случайного леса и градиентного бустинга дают лучшие результаты, с минимальными ошибками и значениями R², близкими к 1. Это говорит о высокой точности в предсказаниях. Линейная регрессия показывает несколько более высокие ошибки, особенно для дорогой недвижимости, но по-прежнему может использоваться как базовая модель.

## Выводы
Случайный лес и градиентный бустинг демонстрируют отличные результаты и могут быть рекомендованы для задач прогнозирования цен на рынке недвижимости в Мадриде. Линейная регрессия также может использоваться как простой и быстрый инструмент, хотя ее точность ниже.

## Использование
Данный проект может быть расширен для анализа рынков недвижимости других регионов, а также для построения более сложных моделей с использованием дополнительных признаков и оптимизации гиперпараметров.

